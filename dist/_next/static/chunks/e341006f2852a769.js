(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),a=e.i(75157);function s({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,a.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...s})}function r({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,a.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...s})}function l({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,a.cn)("leading-none font-semibold",e),...s})}function o({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,a.cn)("text-muted-foreground text-sm",e),...s})}function c({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,a.cn)("px-6",e),...s})}e.s(["Card",()=>s,"CardContent",()=>c,"CardDescription",()=>o,"CardHeader",()=>r,"CardTitle",()=>l])},18566,(e,t,a)=>{t.exports=e.r(76562)},82373,e=>{"use strict";let t=(0,e.i(75254).default)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);e.s(["Volume2",()=>t],82373)},31812,e=>{"use strict";var t=e.i(71645),a=e.i(41931);function s(){let e=(0,t.useRef)(null),s=(0,t.useRef)(null),r=(0,t.useCallback)(()=>{e.current&&(e.current.pause(),e.current.src="",e.current=null),s.current&&(URL.revokeObjectURL(s.current),s.current=null)},[]);(0,t.useEffect)(()=>()=>{r()},[r]);let l=(0,t.useCallback)(async t=>{try{r();let l=await (0,a.apiFetch)("/api/tts",{method:"POST",body:JSON.stringify({text:t,lang:"zh-CN"})});if(!l.ok)return!1;let o=await l.blob(),c=URL.createObjectURL(o);s.current=c;let n=new Audio(c);return e.current=n,n.onended=()=>{r()},n.onerror=()=>{r()},await n.play(),!0}catch(e){return console.warn("Google TTS failed, falling back to Web Speech:",e),r(),!1}},[r]),o=(0,t.useCallback)((e,t="zh-CN")=>{if(!("speechSynthesis"in window))return void console.warn("Speech synthesis not supported");speechSynthesis.cancel();let a=new SpeechSynthesisUtterance(e);a.lang=t,a.rate=.8;let s=speechSynthesis.getVoices().find(e=>e.lang.startsWith("zh")||e.lang.startsWith("cmn"));s&&(a.voice=s),speechSynthesis.speak(a)},[]);return{speak:(0,t.useCallback)(async(e,t="zh-CN")=>{await l(e)||o(e,t)},[l,o]),stop:(0,t.useCallback)(()=>{r(),"speechSynthesis"in window&&speechSynthesis.cancel()},[r])}}e.s(["useSpeech",()=>s])},99682,e=>{"use strict";var t=e.i(71645);function a(e){let a=t.useRef({value:e,previous:e});return t.useMemo(()=>(a.current.value!==e&&(a.current.previous=a.current.value,a.current.value=e),a.current.previous),[e])}e.s(["usePrevious",()=>a])},87316,e=>{"use strict";let t=(0,e.i(75254).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],87316)},20278,e=>{"use strict";let t=(0,e.i(75254).default)("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);e.s(["Target",()=>t],20278)},64030,e=>{"use strict";let t=(0,e.i(75254).default)("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]);e.s(["Trophy",()=>t],64030)},58377,e=>{"use strict";let t=(0,e.i(75254).default)("flame",[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]]);e.s(["Flame",()=>t],58377)},67240,e=>{"use strict";let t=(0,e.i(75254).default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);e.s(["RotateCcw",()=>t],67240)},7180,e=>{"use strict";var t=e.i(43476),a=e.i(71645),s=e.i(18566),r=e.i(31812),l=e.i(19455),o=e.i(82373),c=e.i(75157);let n={1:{label:"Again",emoji:"ðŸ”„",color:"text-red-400",bgColor:"bg-red-500/20 hover:bg-red-500/30",borderColor:"border-red-500/50"},2:{label:"Hard",emoji:"ðŸ˜“",color:"text-orange-400",bgColor:"bg-orange-500/20 hover:bg-orange-500/30",borderColor:"border-orange-500/50"},3:{label:"Good",emoji:"ðŸ‘",color:"text-green-400",bgColor:"bg-green-500/20 hover:bg-green-500/30",borderColor:"border-green-500/50"},4:{label:"Easy",emoji:"ðŸŽ¯",color:"text-blue-400",bgColor:"bg-blue-500/20 hover:bg-blue-500/30",borderColor:"border-blue-500/50"}};function i({wordZh:e,wordPinyin:s,wordEn:i,photoUrl:d,photoDate:h,intervalPreviews:x,onRate:u}){let[m,p]=(0,a.useState)(!1),{speak:b}=(0,r.useSpeech)(),[g,f]=(0,a.useState)(!1),j=h?new Date(h).toLocaleDateString("en-US",{month:"short",day:"numeric"}):null,w=async t=>{t.stopPropagation(),f(!0),await b(e),setTimeout(()=>f(!1),1e3)};return(0,t.jsxs)("div",{className:"w-full max-w-md mx-auto",children:[(0,t.jsx)("div",{className:"relative h-72 cursor-pointer perspective-1000",onClick:()=>{p(!m)},children:(0,t.jsxs)("div",{className:(0,c.cn)("absolute inset-0 w-full h-full transition-transform duration-500 transform-style-3d",m&&"rotate-y-180"),children:[(0,t.jsxs)("div",{className:(0,c.cn)("absolute inset-0 w-full h-full backface-hidden","bg-gradient-to-br from-purple-600 to-purple-800 rounded-2xl","flex flex-col items-center justify-center p-6","shadow-xl border border-purple-500/30"),children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:w,className:(0,c.cn)("absolute top-4 right-4 h-10 w-10 rounded-full",g?"text-white bg-white/20":"text-white/70 hover:text-white hover:bg-white/10"),children:(0,t.jsx)(o.Volume2,{className:"w-5 h-5"})}),(0,t.jsx)("h1",{className:"text-7xl font-bold text-white mb-4",children:e}),(0,t.jsx)("p",{className:"text-white/60 text-sm",children:"Tap to reveal"})]}),(0,t.jsxs)("div",{className:(0,c.cn)("absolute inset-0 w-full h-full backface-hidden rotate-y-180","bg-gradient-to-br from-slate-700 to-slate-800 rounded-2xl","flex flex-col items-center justify-center p-6","shadow-xl border border-slate-600/30"),children:[(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:w,className:(0,c.cn)("absolute top-4 right-4 h-10 w-10 rounded-full",g?"text-white bg-white/20":"text-white/70 hover:text-white hover:bg-white/10"),children:(0,t.jsx)(o.Volume2,{className:"w-5 h-5"})}),d&&(0,t.jsxs)("div",{className:"absolute top-4 left-4 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg overflow-hidden border border-slate-500/50 shadow-lg",children:(0,t.jsx)("img",{src:d,alt:"Where you learned this",className:"w-full h-full object-cover"})}),j&&(0,t.jsx)("span",{className:"text-xs text-slate-400",children:j})]}),(0,t.jsx)("h1",{className:"text-5xl font-bold text-white mb-2",children:e}),(0,t.jsx)("p",{className:"text-2xl text-purple-400 mb-2",children:s}),(0,t.jsx)("p",{className:"text-xl text-slate-300",children:i})]})]})}),m&&(0,t.jsx)("div",{className:"grid grid-cols-4 gap-2 mt-6 animate-fade-in",children:[1,2,3,4].map(e=>{let a=n[e],s=x?.[e];return(0,t.jsxs)(l.Button,{onClick:()=>{p(!1),u(e)},variant:"outline",className:(0,c.cn)("h-16 flex flex-col gap-0.5 px-2",a.borderColor,a.color,a.bgColor),children:[(0,t.jsxs)("span",{className:"text-sm font-medium",children:[a.emoji," ",a.label]}),void 0!==s&&(0,t.jsx)("span",{className:"text-xs opacity-70",children:0===s?"now":1===s?"1d":s<7?`${s}d`:s<30?`${Math.round(s/7)}w`:`${Math.round(s/30)}mo`})]},e)})}),!m&&(0,t.jsx)("p",{className:"text-center text-slate-500 mt-6",children:"Tap the card to see the answer"})]})}var d=e.i(15288),h=e.i(67489);let x=(0,e.i(75254).default)("shuffle",[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]]);var u=e.i(67240),m=e.i(64030),p=e.i(10980),b=e.i(20278),g=e.i(58377),f=e.i(87316),j=e.i(46696),w=e.i(41931);function y(e,t){let{easinessFactor:a,intervalDays:s,repetitions:r,correctStreak:l}=e,o=function(e){switch(e){case 1:return 1;case 2:default:return 3;case 3:return 4;case 4:return 5}}(t),c=Math.max(1.3,a+(.1-(5-o)*(.08+(5-o)*.02)));1===t?(s=1,r=0,l=0):(l++,0===r?s=2===t?2:3===t?4:7:1===r?s=2===t?4:3===t?7:14:(s=Math.round(s*c),2===t?s=Math.max(1,Math.round(.85*s)):4===t&&(s=Math.round(1.3*s))),r++);let n=new Date;n.setDate(n.getDate()+s),n.setHours(0,0,0,0);let i=s>=21;return{easinessFactor:c,intervalDays:s,repetitions:r,correctStreak:l,nextReviewDate:n,isLearned:i}}function v(){let e=(0,s.useRouter)(),[r,o]=(0,a.useState)([]),[c,n]=(0,a.useState)(0),[v,N]=(0,a.useState)(!0),[k,C]=(0,a.useState)([]),[S,M]=(0,a.useState)("all"),[P,T]=(0,a.useState)({total:0,again:0,hard:0,good:0,easy:0}),[A,R]=(0,a.useState)(!1),[z,D]=(0,a.useState)(0),[F,B]=(0,a.useState)(0),[H]=(0,a.useState)(Date.now()),[O]=(0,a.useState)(null),U=async()=>{try{let e=Math.floor((Date.now()-H)/1e3),t=P.good+P.easy,a=P.again+P.hard+P.good+P.easy,s=await (0,w.apiFetch)("/api/stats",{method:"POST",body:JSON.stringify({wordsPracticed:a,wordsKnown:t,durationSeconds:e})});if(s.ok){let e=await s.json();D(e.currentStreak),e.currentStreak>1&&j.toast.success(`${e.currentStreak} day streak!`)}}catch(e){console.error("Failed to record practice session:",e)}},_=(0,a.useCallback)(async e=>{N(!0),R(!1),n(0),T({total:0,again:0,hard:0,good:0,easy:0});try{let t=new URLSearchParams;e&&"all"!==e&&t.set("list",e);let a=await (0,w.apiFetch)(`/api/practice/due-words?${t}`);if(a.ok){let e=await a.json(),t=[...e.items].sort(()=>Math.random()-.5);o(t),B(e.dueCount),T(e=>({...e,total:t.length}))}}catch(e){console.error("Failed to fetch due words:",e)}finally{N(!1)}},[]),V=(0,a.useCallback)(async()=>{try{let e=await (0,w.apiFetch)("/api/lists");if(e.ok){let t=await e.json();C(t)}}catch(e){console.error("Failed to fetch lists:",e)}},[]);(0,a.useEffect)(()=>{_(),V()},[_,V]);let L=async e=>{let t=r[c];if(!t)return;let a={1:"again",2:"hard",3:"good",4:"easy"}[e];T(e=>({...e,[a]:e[a]+1}));try{await (0,w.apiFetch)("/api/word-attempts",{method:"POST",body:JSON.stringify({vocabularyItemId:t.id,sessionId:O,quizMode:"flashcard",rating:e})})}catch(e){console.error("Failed to record attempt:",e)}c<r.length-1?n(e=>e+1):(R(!0),U())},q=r[c],E=r.length>0?(c+1)/r.length*100:0,$=q?{easinessFactor:q.easiness_factor||2.5,intervalDays:q.interval_days||0,repetitions:q.repetitions||0,correctStreak:q.correct_streak||0}:null,G=$?{1:1,2:y($,2).intervalDays,3:y($,3).intervalDays,4:y($,4).intervalDays}:void 0;if(v)return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-lg",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Practice"}),(0,t.jsx)("div",{className:"h-72 bg-slate-800/50 rounded-2xl animate-pulse"})]});if(0===r.length)return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-lg",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Practice"}),(0,t.jsxs)("div",{className:"text-center py-16",children:[(0,t.jsx)("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-slate-800 flex items-center justify-center",children:(0,t.jsx)(p.BookOpen,{className:"w-8 h-8 text-slate-500"})}),(0,t.jsx)("h2",{className:"text-xl font-medium text-white mb-2",children:"No words due for review"}),(0,t.jsx)("p",{className:"text-slate-400 mb-6",children:0===F?"Add some vocabulary by analyzing photos, or check back tomorrow!":"Great job! Come back later for more practice."}),(0,t.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,t.jsx)(l.Button,{onClick:()=>e.push("/capture"),className:"bg-purple-600 hover:bg-purple-700",children:"Capture Photo"}),(0,t.jsx)(l.Button,{onClick:()=>e.push("/progress"),variant:"outline",className:"border-slate-600",children:"View Progress"})]})]})]});if(A){let a=P.again+P.hard+P.good+P.easy,s=P.good+P.easy,c=a>0?Math.round(s/a*100):0;return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-lg",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Practice Complete!"}),(0,t.jsxs)(d.Card,{className:"bg-slate-800/50 border-slate-700 p-8 text-center",children:[(0,t.jsx)("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center",children:(0,t.jsx)(m.Trophy,{className:"w-10 h-10 text-white"})}),(0,t.jsxs)("h2",{className:"text-3xl font-bold text-white mb-2",children:[c,"% Success!"]}),(0,t.jsxs)("p",{className:"text-slate-400 mb-4",children:["You reviewed ",a," words"]}),z>0&&(0,t.jsxs)("div",{className:"inline-flex items-center gap-2 bg-orange-500/20 text-orange-400 px-4 py-2 rounded-full mb-6",children:[(0,t.jsx)(g.Flame,{className:"w-5 h-5"}),(0,t.jsxs)("span",{className:"font-bold",children:[z," day streak!"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-2 mb-8",children:[(0,t.jsxs)("div",{className:"bg-red-500/10 rounded-xl p-3 border border-red-500/30",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-red-400",children:P.again}),(0,t.jsx)("p",{className:"text-xs text-red-400/80",children:"Again"})]}),(0,t.jsxs)("div",{className:"bg-orange-500/10 rounded-xl p-3 border border-orange-500/30",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-orange-400",children:P.hard}),(0,t.jsx)("p",{className:"text-xs text-orange-400/80",children:"Hard"})]}),(0,t.jsxs)("div",{className:"bg-green-500/10 rounded-xl p-3 border border-green-500/30",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-green-400",children:P.good}),(0,t.jsx)("p",{className:"text-xs text-green-400/80",children:"Good"})]}),(0,t.jsxs)("div",{className:"bg-blue-500/10 rounded-xl p-3 border border-blue-500/30",children:[(0,t.jsx)("p",{className:"text-2xl font-bold text-blue-400",children:P.easy}),(0,t.jsx)("p",{className:"text-xs text-blue-400/80",children:"Easy"})]})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(l.Button,{onClick:()=>{o([...r].sort(()=>Math.random()-.5)),n(0),T({total:r.length,again:0,hard:0,good:0,easy:0}),R(!1)},variant:"outline",className:"flex-1 border-slate-600 text-slate-200",children:[(0,t.jsx)(u.RotateCcw,{className:"w-4 h-4 mr-2"}),"Practice Again"]}),(0,t.jsx)(l.Button,{onClick:()=>e.push("/progress"),className:"flex-1 bg-purple-600 hover:bg-purple-700",children:"View Progress"})]})]})]})}return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-white",children:"Practice"}),(0,t.jsxs)("p",{className:"text-slate-400",children:[c+1," of ",r.length]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[F>0&&(0,t.jsxs)("div",{className:"flex items-center gap-1 text-sm text-purple-400 bg-purple-500/10 px-2 py-1 rounded-full",children:[(0,t.jsx)(f.Calendar,{className:"w-4 h-4"}),(0,t.jsxs)("span",{children:[F," due"]})]}),(0,t.jsx)(l.Button,{variant:"ghost",size:"icon",onClick:()=>{o([...r].sort(()=>Math.random()-.5)),n(0)},className:"text-slate-400 hover:text-white",children:(0,t.jsx)(x,{className:"w-5 h-5"})})]})]}),(0,t.jsx)("div",{className:"mb-6",children:(0,t.jsxs)(h.Select,{value:S,onValueChange:e=>{M(e),_("all"===e?void 0:e)},children:[(0,t.jsx)(h.SelectTrigger,{className:"bg-slate-800/50 border-slate-600 text-white",children:(0,t.jsx)(h.SelectValue,{placeholder:"All words"})}),(0,t.jsxs)(h.SelectContent,{className:"bg-slate-800 border-slate-700",children:[(0,t.jsx)(h.SelectItem,{value:"all",className:"text-white focus:bg-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(b.Target,{className:"w-4 h-4 text-purple-400"}),"All words (",r.length,")"]})}),k.map(e=>(0,t.jsx)(h.SelectItem,{value:e.id,className:"text-white focus:bg-slate-700",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),e.name]})},e.id))]})]})}),(0,t.jsx)("div",{className:"h-2 bg-slate-700 rounded-full mb-6 overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-purple-600 transition-all duration-300",style:{width:`${E}%`}})}),q&&(0,t.jsx)(i,{wordZh:q.word_zh,wordPinyin:q.word_pinyin,wordEn:q.word_en,photoUrl:q.photo_url,photoDate:q.photo_date,intervalPreviews:G,onRate:L}),(0,t.jsxs)("div",{className:"flex justify-center gap-4 mt-8",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-red-400",children:P.again}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Again"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-orange-400",children:P.hard}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Hard"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-green-400",children:P.good}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Good"})]}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"text-xl font-bold text-blue-400",children:P.easy}),(0,t.jsx)("p",{className:"text-xs text-slate-500",children:"Easy"})]})]})]})}e.s(["default",()=>v],7180)}]);