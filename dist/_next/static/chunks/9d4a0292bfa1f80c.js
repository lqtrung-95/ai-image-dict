(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67027,e=>{"use strict";var s=e.i(71645),t=e.i(75157),a=e.i(41931);function l(){let[e,l]=(0,s.useState)("idle"),[i,r]=(0,s.useState)(null),[n,c]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),m=(0,s.useCallback)(async e=>{l("analyzing"),c(null);try{let s=await (0,t.compressImage)(e,1024),i=(0,t.extractBase64)(s),n=await (0,a.apiFetch)("/api/analyze",{method:"POST",body:JSON.stringify({image:i})}),c=await n.json();if(!n.ok){if(429===n.status&&"LIMIT_EXCEEDED"===c.code){d(c.usage),l("limit_exceeded");return}throw Error(c.error||"Analysis failed")}c.usage&&d(c.usage),r(c),l("result")}catch(e){c(e instanceof Error?e.message:"Failed to analyze image"),l("error")}},[]);return{stage:e,analysisData:i,error:n,usage:o,analyze:m,reset:(0,s.useCallback)(()=>{l("idle"),c(null),r(null)},[]),dismissLimitModal:(0,s.useCallback)(()=>{l("idle")},[]),isLimitExceeded:"limit_exceeded"===e}}e.s(["useAnalyze",()=>l])},39312,e=>{"use strict";let s=(0,e.i(75254).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["Zap",()=>s],39312)},36339,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(76639),l=e.i(19455),i=e.i(55764),r=e.i(83086),n=e.i(39312),c=e.i(68553),o=e.i(10980),d=e.i(43531),m=e.i(46696),u=e.i(41931);let x=[{icon:c.Camera,text:"Unlimited photo analyses"},{icon:o.BookOpen,text:"Unlimited vocabulary saves"},{icon:n.Zap,text:"Priority AI processing"},{icon:r.Sparkles,text:"No daily limits"}];function h({open:e,onClose:n,usage:c}){let[o,h]=(0,t.useState)(""),[p,g]=(0,t.useState)(!1),[f,y]=(0,t.useState)(!1),b=async()=>{g(!0);try{(await (0,u.apiFetch)("/api/upgrade-interest",{method:"POST",body:JSON.stringify({email:o||null,reason:"limit_reached"})})).ok?(y(!0),m.toast.success("Thanks! We'll notify you when Premium launches.")):m.toast.error("Something went wrong. Please try again.")}catch{m.toast.error("Something went wrong. Please try again.")}finally{g(!1)}};return(0,s.jsx)(a.Dialog,{open:e,onOpenChange:e=>!e&&n(),children:(0,s.jsxs)(a.DialogContent,{className:"sm:max-w-md bg-slate-900 border-slate-700",children:[(0,s.jsx)(a.DialogHeader,{children:(0,s.jsx)(a.DialogTitle,{className:"text-center",children:(0,s.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center",children:(0,s.jsx)(r.Sparkles,{className:"w-8 h-8 text-white"})}),(0,s.jsx)("span",{className:"text-2xl font-bold text-white",children:"Daily Limit Reached"})]})})}),(0,s.jsxs)("div",{className:"space-y-6 py-4",children:[c&&(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-slate-400",children:["You've used"," ",(0,s.jsxs)("span",{className:"text-white font-semibold",children:[c.current,"/",c.limit]})," ","free analyses today"]}),(0,s.jsx)("div",{className:"mt-2 h-2 bg-slate-700 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all",style:{width:`${Math.min(100,c.current/c.limit*100)}%`}})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-slate-400 text-center",children:"Upgrade to Premium for unlimited access:"}),(0,s.jsx)("div",{className:"grid gap-2",children:x.map(e=>(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:[(0,s.jsx)(e.icon,{className:"w-5 h-5 text-purple-400"}),(0,s.jsx)("span",{className:"text-slate-200",children:e.text})]},e.text))})]}),f?(0,s.jsxs)("div",{className:"text-center p-4 rounded-lg bg-green-500/10 border border-green-500/30",children:[(0,s.jsx)(d.Check,{className:"w-8 h-8 text-green-400 mx-auto mb-2"}),(0,s.jsx)("p",{className:"text-green-400 font-medium",children:"You're on the list!"}),(0,s.jsx)("p",{className:"text-sm text-slate-400 mt-1",children:"We'll email you when Premium is ready."})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-slate-400 text-center",children:"Premium is coming soon! Get notified:"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(i.Input,{type:"email",placeholder:"your@email.com (optional)",value:o,onChange:e=>h(e.target.value),className:"bg-slate-800 border-slate-700 text-white placeholder:text-slate-500"}),(0,s.jsx)(l.Button,{onClick:b,disabled:p,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 whitespace-nowrap",children:p?"Saving...":"Notify Me"})]})]}),(0,s.jsxs)("p",{className:"text-xs text-slate-500 text-center",children:["Your free analyses reset at midnight UTC.",(0,s.jsx)("br",{}),"Come back tomorrow for ",c?.limit||6," more!"]})]})]})})}e.s(["UpgradeModal",()=>h])},83086,e=>{"use strict";let s=(0,e.i(75254).default)("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]);e.s(["Sparkles",()=>s],83086)},16715,e=>{"use strict";let s=(0,e.i(75254).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>s],16715)},37727,e=>{"use strict";var s=e.i(41947);e.s(["X",()=>s.default])},63209,e=>{"use strict";let s=(0,e.i(75254).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],63209)},78894,e=>{"use strict";var s=e.i(82458);e.s(["AlertTriangle",()=>s.default])},52702,e=>{"use strict";var s=e.i(71645);function t(){let[e,t]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{let e=()=>{let e="ontouchstart"in window||navigator.maxTouchPoints>0,s=window.matchMedia("(max-width: 768px)").matches;t(e&&s)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),e}e.s(["useIsMobile",()=>t])},72080,e=>{"use strict";let s=(0,e.i(75254).default)("image-plus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);e.s(["ImagePlus",()=>s],72080)},6039,e=>{"use strict";var s=e.i(43476),t=e.i(2747);function a(){return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)(t.Skeleton,{className:"w-full aspect-video rounded-xl bg-slate-700"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(t.Skeleton,{className:"h-4 w-32 bg-slate-700"}),(0,s.jsx)(t.Skeleton,{className:"h-6 w-full bg-slate-700"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(t.Skeleton,{className:"h-4 w-40 bg-slate-700"}),(0,s.jsx)("div",{className:"grid gap-4 grid-cols-2 md:grid-cols-3",children:Array.from({length:6}).map((e,a)=>(0,s.jsxs)("div",{className:"p-4 rounded-xl bg-slate-800/50 border border-slate-700",children:[(0,s.jsx)(t.Skeleton,{className:"h-10 w-16 mb-2 bg-slate-700"}),(0,s.jsx)(t.Skeleton,{className:"h-4 w-12 mb-1 bg-slate-700"}),(0,s.jsx)(t.Skeleton,{className:"h-3 w-20 bg-slate-700"})]},a))})]})]})}function l(){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-20 h-20 rounded-full bg-purple-500/20 animate-pulse"}),(0,s.jsx)("div",{className:"absolute inset-0 w-20 h-20 rounded-full border-2 border-purple-500 border-t-transparent animate-spin"})]}),(0,s.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:"Analyzing your photo..."}),(0,s.jsx)("p",{className:"text-slate-400 max-w-sm",children:"Our AI is detecting objects and translating them to Chinese. This usually takes a few seconds."})]})}e.s(["AnalysisSkeleton",()=>a,"AnalyzingState",()=>l])},66001,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(19455),l=e.i(78894);function i({title:e="Error",message:t,onRetry:i}){return(0,s.jsx)("div",{className:"p-4 rounded-lg bg-red-900/20 border border-red-800",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(l.AlertTriangle,{className:"w-5 h-5 text-red-400 mt-0.5"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-medium text-red-400",children:e}),(0,s.jsx)("p",{className:"text-sm text-red-300/80 mt-1",children:t}),i&&(0,s.jsx)(a.Button,{variant:"ghost",size:"sm",onClick:i,className:"mt-2 text-red-400 hover:text-red-300 hover:bg-red-900/20 p-0 h-auto",children:"Try again"})]})]})})}e.i(16715),t.Component,e.s(["ErrorMessage",()=>i])},60127,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(19455),l=e.i(69074),i=e.i(72080),r=e.i(37727),n=e.i(63209),c=e.i(75157),o=e.i(52702);function d({onUpload:e,className:d}){let m=(0,o.useIsMobile)(),[u,x]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[g,f]=(0,t.useState)(null),y=(0,t.useRef)(null),b=(0,t.useCallback)(async e=>{p(null);let s=(0,c.validateImageFile)(e);if(!s.valid)return void p(s.error||"Invalid file");try{let s=await (0,c.fileToBase64)(e);f(s)}catch{p("Failed to process image")}},[]),j=(0,t.useCallback)(e=>{e.preventDefault(),x(!1);let s=e.dataTransfer.files[0];s&&b(s)},[b]),v=(0,t.useCallback)(e=>{e.preventDefault(),x(!0)},[]),N=(0,t.useCallback)(e=>{e.preventDefault(),x(!1)},[]),w=(0,t.useCallback)(e=>{let s=e.target.files?.[0];s&&b(s)},[b]),k=(0,t.useCallback)(e=>{for(let s of e.clipboardData.items)if(s.type.startsWith("image/")){let e=s.getAsFile();e&&b(e);break}},[b]),S=()=>{f(null),p(null),y.current&&(y.current.value="")};return g?(0,s.jsxs)("div",{className:(0,c.cn)("space-y-4",d),children:[(0,s.jsxs)("div",{className:"relative rounded-xl overflow-hidden",children:[(0,s.jsx)("img",{src:g,alt:"Preview",className:"w-full max-h-[60vh] object-contain bg-slate-800"}),(0,s.jsx)(a.Button,{variant:"outline",size:"icon",onClick:S,className:"absolute top-2 right-2 rounded-full bg-black/50 border-white/20 text-white hover:bg-black/70",children:(0,s.jsx)(r.X,{className:"w-4 h-4"})})]}),(0,s.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,s.jsx)(a.Button,{variant:"outline",onClick:S,className:"border-slate-600",children:"Choose Different"}),(0,s.jsx)(a.Button,{onClick:()=>{g&&e(g)},className:"bg-purple-600 hover:bg-purple-700",children:"Analyze Photo"})]})]}):(0,s.jsxs)("div",{className:(0,c.cn)("relative rounded-xl border-2 border-dashed transition-colors",u?"border-purple-500 bg-purple-500/10":"border-slate-600 hover:border-slate-500",d),onDrop:j,onDragOver:v,onDragLeave:N,onPaste:k,tabIndex:0,children:[(0,s.jsx)("input",{ref:y,type:"file",accept:"image/jpeg,image/png,image/webp",onChange:w,className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer"}),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-slate-700/50 flex items-center justify-center mb-4",children:u?(0,s.jsx)(i.ImagePlus,{className:"w-8 h-8 text-purple-400"}):(0,s.jsx)(l.Upload,{className:"w-8 h-8 text-slate-400"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-white mb-2",children:u?"Drop your image here":m?"Take or choose a photo":"Upload a photo"}),(0,s.jsx)("p",{className:"text-slate-400 text-sm mb-4",children:m?"Tap to take a photo or select from gallery":"Drag and drop, paste, or click to select"}),(0,s.jsx)("p",{className:"text-slate-500 text-xs",children:"Supports JPEG, PNG, WebP (max 5MB)"}),h&&(0,s.jsxs)("div",{className:"mt-4 flex items-center gap-2 text-red-400 text-sm",children:[(0,s.jsx)(n.AlertCircle,{className:"w-4 h-4"}),h]})]})]})}e.s(["PhotoUpload",()=>d])},87688,e=>{"use strict";var s=e.i(43476),t=e.i(60127),a=e.i(6039),l=e.i(59185),i=e.i(66001),r=e.i(36339),n=e.i(67027),c=e.i(41931);function o(){let{stage:e,analysisData:o,error:d,usage:m,analyze:u,reset:x,dismissLimitModal:h,isLimitExceeded:p}=(0,n.useAnalyze)(),g=async e=>{let s=await (0,c.apiFetch)("/api/vocabulary",{method:"POST",body:JSON.stringify(e)});if(!s.ok&&409!==s.status)throw Error("Failed to save word")},f="idle"===e||"limit_exceeded"===e?"upload":e;return(0,s.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:[(0,s.jsxs)("h1",{className:"text-2xl font-bold text-white mb-6",children:["upload"===f&&"Upload Photo","analyzing"===f&&"Analyzing...","result"===f&&"Analysis Results","error"===f&&"Error"]}),m&&"upload"===f&&(0,s.jsxs)("div",{className:"mb-4 p-3 rounded-lg bg-slate-800/50 border border-slate-700",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-slate-400",children:"Daily analyses"}),(0,s.jsxs)("span",{className:"text-slate-300",children:[m.remaining," of ",m.limit," remaining"]})]}),(0,s.jsx)("div",{className:"h-1.5 bg-slate-700 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all",style:{width:`${(m.limit-m.remaining)/m.limit*100}%`}})})]}),"upload"===f&&(0,s.jsx)(t.PhotoUpload,{onUpload:u}),"analyzing"===f&&(0,s.jsx)(a.AnalyzingState,{}),"result"===f&&o&&(0,s.jsx)(l.AnalysisResult,{id:o.id,imageUrl:o.imageUrl,sceneDescription:o.sceneDescription,sceneDescriptionZh:o.sceneDescriptionZh,sceneDescriptionPinyin:o.sceneDescriptionPinyin,objects:o.objects,exampleSentences:o.exampleSentences,hskLevels:o.hskLevels,onSaveWord:g,onUploadAnother:x}),"error"===f&&(0,s.jsx)(i.ErrorMessage,{title:"Analysis Failed",message:d||"Something went wrong. Please try again.",onRetry:x}),(0,s.jsx)(r.UpgradeModal,{open:p,onClose:h,usage:m?{current:m.current,limit:m.limit}:void 0})]})}e.s(["default",()=>o])}]);