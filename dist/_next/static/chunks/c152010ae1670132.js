(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15288,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function r({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...r})}function a({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...r})}function i({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-title",className:(0,s.cn)("leading-none font-semibold",e),...r})}function l({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-description",className:(0,s.cn)("text-muted-foreground text-sm",e),...r})}function o({className:e,...r}){return(0,t.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...r})}e.s(["Card",()=>r,"CardContent",()=>o,"CardDescription",()=>l,"CardHeader",()=>a,"CardTitle",()=>i])},18566,(e,t,s)=>{t.exports=e.r(76562)},55764,e=>{"use strict";var t=e.i(43476),s=e.i(75157);function r({className:e,type:r,...a}){return(0,t.jsx)("input",{type:r,"data-slot":"input",className:(0,s.cn)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...a})}e.s(["Input",()=>r])},43531,e=>{"use strict";var t=e.i(78745);e.s(["Check",()=>t.default])},24687,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(75157);let a=s.forwardRef(({className:e,...s},a)=>(0,t.jsx)("textarea",{className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...s}));a.displayName="Textarea",e.s(["Textarea",()=>a])},3408,e=>{"use strict";let t=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>t])},73375,e=>{"use strict";let t=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>t],73375)},35501,e=>{"use strict";var t=e.i(3408);e.s(["ImageIcon",()=>t.default])},5672,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18566),a=e.i(15288),i=e.i(19455),l=e.i(55764),o=e.i(24687),d=e.i(73375),n=e.i(43531),c=e.i(35501),u=e.i(11795),x=e.i(46696),m=e.i(22016),h=e.i(41931);function p(){let e=(0,r.useRouter)(),[p,f]=(0,s.useState)([]),[b,g]=(0,s.useState)(new Set),[v,j]=(0,s.useState)(""),[y,N]=(0,s.useState)(""),[w,C]=(0,s.useState)(!0),[k,S]=(0,s.useState)(!1);(0,s.useEffect)(()=>{T()},[]);let T=async()=>{let e=(0,u.createClient)(),{data:t,error:s}=await e.from("photo_analyses").select("id, image_url, scene_context").order("created_at",{ascending:!1});s?x.toast.error("Failed to load photos"):f(t||[]),C(!1)},P=async()=>{if(!v.trim())return void x.toast.error("Please enter a title");if(0===b.size)return void x.toast.error("Please select at least one photo");S(!0);try{let t=await (0,h.apiFetch)("/api/stories",{method:"POST",body:JSON.stringify({title:v,description:y,photoIds:Array.from(b)})});if(t.ok){let s=await t.json();x.toast.success("Story created!"),e.push(`/stories/${s.story.id}`)}else throw Error("Failed to create story")}catch(e){x.toast.error("Failed to create story"),S(!1)}};return w?(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:[(0,t.jsx)("div",{className:"h-8 w-48 bg-slate-800/50 rounded animate-pulse mb-6"}),(0,t.jsx)("div",{className:"h-32 bg-slate-800/50 rounded-xl animate-pulse"})]}):(0,t.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:[(0,t.jsx)(m.default,{href:"/stories",children:(0,t.jsxs)(i.Button,{variant:"ghost",className:"mb-4 -ml-2 text-slate-400",children:[(0,t.jsx)(d.ChevronLeft,{className:"w-4 h-4 mr-1"}),"Back to Stories"]})}),(0,t.jsx)("h1",{className:"text-2xl font-bold text-white mb-6",children:"Create Photo Story"}),(0,t.jsx)(a.Card,{className:"bg-slate-800/50 border-slate-700 p-6 mb-6",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-slate-400 mb-1 block",children:"Story Title"}),(0,t.jsx)(l.Input,{value:v,onChange:e=>j(e.target.value),placeholder:"e.g., My Kitchen, At the Park...",className:"bg-slate-700 border-slate-600 text-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-sm text-slate-400 mb-1 block",children:"Description (optional)"}),(0,t.jsx)(o.Textarea,{value:y,onChange:e=>N(e.target.value),placeholder:"Describe what this story is about...",className:"bg-slate-700 border-slate-600 text-white",rows:3})]})]})}),(0,t.jsx)("div",{className:"mb-4 flex items-center justify-between",children:(0,t.jsxs)("h2",{className:"text-lg font-semibold text-white",children:["Select Photos",(0,t.jsxs)("span",{className:"ml-2 text-sm text-slate-400",children:["(",b.size," selected)"]})]})}),0===p.length?(0,t.jsxs)(a.Card,{className:"bg-slate-800/50 border-slate-700 p-8 text-center",children:[(0,t.jsx)(c.ImageIcon,{className:"w-12 h-12 text-slate-600 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-400",children:"No photos yet. Capture some photos first!"}),(0,t.jsx)(m.default,{href:"/capture",children:(0,t.jsx)(i.Button,{className:"mt-4 bg-purple-600 hover:bg-purple-700",children:"Capture Photo"})})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 mb-6",children:p.map(e=>(0,t.jsxs)("div",{onClick:()=>{var t;return t=e.id,void g(e=>{let s=new Set(e);return s.has(t)?s.delete(t):s.add(t),s})},className:`relative aspect-square rounded-lg overflow-hidden cursor-pointer border-2 transition-all ${b.has(e.id)?"border-purple-500 ring-2 ring-purple-500/30":"border-slate-700 hover:border-slate-500"}`,children:[(0,t.jsx)("img",{src:e.image_url,alt:"",className:"w-full h-full object-cover"}),b.has(e.id)&&(0,t.jsx)("div",{className:"absolute inset-0 bg-purple-600/20 flex items-center justify-center",children:(0,t.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center",children:(0,t.jsx)(n.Check,{className:"w-5 h-5 text-white"})})})]},e.id))}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)(i.Button,{onClick:P,disabled:k||!v.trim()||0===b.size,className:"bg-purple-600 hover:bg-purple-700",children:k?"Creating...":"Create Story"})})]})]})}e.s(["default",()=>p])}]);